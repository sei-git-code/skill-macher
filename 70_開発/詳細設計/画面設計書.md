# 画面設計書

## 1. 画面設計概要

### 1.1 設計方針
- **サーバーサイドレンダリング**: ThymeleafによるSSR
- **レスポンシブデザイン**: Bootstrap 5によるPC、タブレット、スマートフォン対応
- **アクセシビリティ**: WCAG 2.1 AA準拠
- **ユーザビリティ**: 直感的な操作とナビゲーション
- **デザインシステム**: Bootstrap + カスタムCSS

### 1.2 画面一覧
1. **ログイン画面** (LOGIN)
2. **ダッシュボード画面** (DASHBOARD)
3. **人員募集要項管理画面** (JOB_MANAGEMENT)
4. **SES人員管理画面** (EMPLOYEE_MANAGEMENT)
5. **スキルマッチング画面** (SKILL_MATCHING)
6. **レポート画面** (REPORTS)
7. **ユーザー設定画面** (USER_SETTINGS)

## 2. 共通レイアウト

### 2.1 ヘッダー (Thymeleaf + Bootstrap)
```html
<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container-fluid">
        <a class="navbar-brand" href="/dashboard">SES営業支援ツール</a>
        <div class="navbar-nav ms-auto">
            <span class="navbar-text me-3" th:text="${user.name}">ユーザー名</span>
            <a class="btn btn-outline-light" href="/logout">ログアウト</a>
        </div>
    </div>
</nav>
```

### 2.2 サイドバー (Thymeleaf + Bootstrap)
```html
<div class="col-md-3 col-lg-2 px-0">
    <div class="d-flex flex-column p-3 bg-light h-100">
        <ul class="nav nav-pills flex-column mb-auto">
            <li class="nav-item">
                <a class="nav-link" href="/dashboard">📊 ダッシュボード</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/job-requirements">📝 要項管理</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/employees">👥 人員管理</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/matching">🔍 マッチング</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/reports">📈 レポート</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="/settings">⚙️ 設定</a>
            </li>
        </ul>
    </div>
</div>
```

### 2.3 メインコンテンツエリア (Bootstrap Grid)
- **幅**: Bootstrap container-fluid
- **余白**: Bootstrap spacing utilities
- **背景色**: Bootstrap bg-light

## 3. 画面詳細設計

### 3.1 ログイン画面 (LOGIN)

#### 3.1.1 レイアウト (Thymeleaf + Bootstrap)
```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ログイン - SES営業支援ツール</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-6 col-lg-4">
                <div class="card shadow mt-5">
                    <div class="card-body p-5">
                        <h2 class="text-center mb-4">SES営業支援ツール</h2>
                        <form th:action="@{/login}" method="post">
                            <div class="mb-3">
                                <label for="email" class="form-label">メールアドレス</label>
                                <input type="email" class="form-control" id="email" name="email" required>
                            </div>
                            <div class="mb-3">
                                <label for="password" class="form-label">パスワード</label>
                                <input type="password" class="form-control" id="password" name="password" required>
                            </div>
                            <div class="d-grid">
                                <button type="submit" class="btn btn-primary">ログイン</button>
                            </div>
                        </form>
                        <div class="text-center mt-3">
                            <a href="/forgot-password" class="text-decoration-none">パスワードを忘れた場合</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
```

#### 3.1.2 機能仕様 (Spring Boot Controller)
```java
@Controller
public class LoginController {
    
    @GetMapping("/login")
    public String loginPage(Model model) {
        return "login";
    }
    
    @PostMapping("/login")
    public String login(@RequestParam String email, 
                       @RequestParam String password,
                       Model model) {
        // Spring Security による認証処理
        return "redirect:/dashboard";
    }
    
    @GetMapping("/forgot-password")
    public String forgotPasswordPage() {
        return "forgot-password";
    }
}
```

#### 3.1.3 バリデーション (Spring Boot Validation)
```java
public class LoginRequest {
    @NotBlank(message = "メールアドレスは必須です")
    @Email(message = "有効なメールアドレスを入力してください")
    private String email;
    
    @NotBlank(message = "パスワードは必須です")
    @Size(min = 8, message = "パスワードは8文字以上で入力してください")
    private String password;
}
```

#### 3.1.4 状態管理
- **ローディング状態**: Thymeleaf + Bootstrap spinner
- **エラー状態**: Spring Boot Validation + Thymeleaf error表示
- **成功状態**: Spring Security による認証成功後のリダイレクト

### 3.2 ダッシュボード画面 (DASHBOARD)

#### 3.2.1 レイアウト (Thymeleaf + Bootstrap)
```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ダッシュボード - SES営業支援ツール</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <!-- ヘッダー -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container-fluid">
            <a class="navbar-brand" href="/dashboard">SES営業支援ツール</a>
            <div class="navbar-nav ms-auto">
                <span class="navbar-text me-3" th:text="${user.name}">ユーザー名</span>
                <a class="btn btn-outline-light" href="/logout">ログアウト</a>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <div class="col-md-3 col-lg-2 px-0">
                <div class="d-flex flex-column p-3 bg-light h-100">
                    <ul class="nav nav-pills flex-column mb-auto">
                        <li class="nav-item">
                            <a class="nav-link active" href="/dashboard">📊 ダッシュボード</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/job-requirements">📝 要項管理</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/employees">👥 人員管理</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/matching">🔍 マッチング</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/reports">📈 レポート</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/settings">⚙️ 設定</a>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- メインコンテンツ -->
            <div class="col-md-9 col-lg-10 p-4">
                <h1 class="mb-4">ダッシュボード</h1>
                
                <!-- 統計カード -->
                <div class="row mb-4">
                    <div class="col-md-4">
                        <div class="card text-center">
                            <div class="card-body">
                                <h5 class="card-title">要項数</h5>
                                <h2 class="text-primary" th:text="${stats.jobRequirementCount}">25</h2>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card text-center">
                            <div class="card-body">
                                <h5 class="card-title">人員数</h5>
                                <h2 class="text-success" th:text="${stats.employeeCount}">150</h2>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card text-center">
                            <div class="card-body">
                                <h5 class="card-title">マッチング数</h5>
                                <h2 class="text-info" th:text="${stats.matchingCount}">180</h2>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 最近のマッチング結果 -->
                <div class="row">
                    <div class="col-md-8">
                        <div class="card">
                            <div class="card-header">
                                <h5>最近のマッチング結果</h5>
                            </div>
                            <div class="card-body">
                                <div class="list-group" th:each="result : ${recentMatchingResults}">
                                    <div class="list-group-item">
                                        <div class="d-flex w-100 justify-content-between">
                                            <h6 class="mb-1" th:text="${result.projectName}">ECサイト開発</h6>
                                            <small th:text="${result.employeeName}">山田花子</small>
                                        </div>
                                        <div class="d-flex justify-content-between align-items-center">
                                            <span th:text="${result.overallScore} + '%'">85%</span>
                                            <a th:href="@{/matching/{id}(id=${result.id})}" class="btn btn-sm btn-outline-primary">詳細</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-header">
                                <h5>スキル需要ランキング</h5>
                            </div>
                            <div class="card-body">
                                <ol class="list-group list-group-numbered" th:each="skill : ${skillDemandRanking}">
                                    <li class="list-group-item d-flex justify-content-between align-items-start">
                                        <div class="ms-2 me-auto">
                                            <div class="fw-bold" th:text="${skill.technology}">React</div>
                                        </div>
                                        <span class="badge bg-primary rounded-pill" th:text="${skill.demandCount} + '件'">45件</span>
                                    </li>
                                </ol>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
```

#### 3.2.2 機能仕様 (Spring Boot Controller)
```java
@Controller
@RequestMapping("/dashboard")
public class DashboardController {
    
    @Autowired
    private DashboardService dashboardService;
    
    @GetMapping
    public String dashboard(Model model, Authentication authentication) {
        // 統計データの取得
        DashboardStats stats = dashboardService.getDashboardStats();
        model.addAttribute("stats", stats);
        
        // 最近のマッチング結果
        List<MatchingResult> recentResults = dashboardService.getRecentMatchingResults(5);
        model.addAttribute("recentMatchingResults", recentResults);
        
        // スキル需要ランキング
        List<SkillDemand> skillRanking = dashboardService.getSkillDemandRanking(10);
        model.addAttribute("skillDemandRanking", skillRanking);
        
        // ユーザー情報
        User user = (User) authentication.getPrincipal();
        model.addAttribute("user", user);
        
        return "dashboard";
    }
}
```

#### 3.2.3 Service層実装
```java
@Service
public class DashboardService {
    
    @Autowired
    private JobRequirementRepository jobRequirementRepository;
    
    @Autowired
    private EmployeeRepository employeeRepository;
    
    @Autowired
    private MatchingResultRepository matchingResultRepository;
    
    public DashboardStats getDashboardStats() {
        long jobCount = jobRequirementRepository.count();
        long employeeCount = employeeRepository.count();
        long matchingCount = matchingResultRepository.count();
        
        return new DashboardStats(jobCount, employeeCount, matchingCount);
    }
    
    public List<MatchingResult> getRecentMatchingResults(int limit) {
        return matchingResultRepository.findTop5ByOrderByCreatedAtDesc();
    }
    
    public List<SkillDemand> getSkillDemandRanking(int limit) {
        return skillDemandRepository.findTop10ByOrderByDemandCountDesc();
    }
}
```

### 3.3 人員募集要項管理画面 (JOB_MANAGEMENT)

#### 3.3.1 レイアウト
```
┌─────────────────────────────────────────────────────────┐
│ 人員募集要項管理                    [新規作成] [検索] [フィルタ] │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 要項一覧                                            │ │
│ │ ┌─────────────────────────────────────────────────┐ │ │
│ │ │ ECサイト開発    │ 株式会社A │ 2024/01/15 │ [編集] │ │ │
│ │ │ モバイルアプリ  │ 株式会社B │ 2024/01/14 │ [編集] │ │ │
│ │ │ Webシステム    │ 株式会社C │ 2024/01/13 │ [編集] │ │ │
│ │ └─────────────────────────────────────────────────┘ │ │
│ └─────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────┘
```

#### 3.3.2 要項作成・編集モーダル
```
┌─────────────────────────────────────────────────────────┐
│ 人員募集要項 [新規作成/編集]                    [×]     │
├─────────────────────────────────────────────────────────┤
│ プロジェクト名: [________________]                     │
│ クライアント名: [________________]                      │
│ 説明: [________________________]                        │
│                                                         │
│ 必須スキル: [React ▼] [Node.js ▼] [+ 追加]             │
│ 希望スキル: [TypeScript ▼] [AWS ▼] [+ 追加]           │
│                                                         │
│ 経験年数: [3] 年                                         │
│ 予算範囲: [500-800万円 ▼]                               │
│ 開始日: [2024/02/01] 終了日: [2024/08/31]              │
│ 勤務地: [東京都 ▼] 勤務形態: [ハイブリッド ▼]           │
│                                                         │
│ その他要件: [________________]                         │
│                                                         │
│ [キャンセル] [保存]                                     │
└─────────────────────────────────────────────────────────┘
```

#### 3.3.3 機能仕様
- **一覧表示**:
  - 要項の一覧表示
  - ページネーション
  - ソート機能
- **検索・フィルタ**:
  - プロジェクト名検索
  - ステータスフィルタ
  - 日付範囲フィルタ
- **CRUD操作**:
  - 新規作成
  - 編集
  - 削除
  - 複製

### 3.4 SES人員管理画面 (EMPLOYEE_MANAGEMENT)

#### 3.4.1 レイアウト
```
┌─────────────────────────────────────────────────────────┐
│ SES人員管理                        [新規登録] [検索] [フィルタ] │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 人員一覧                                            │ │
│ │ ┌─────────────────────────────────────────────────┐ │ │
│ │ │ EMP001 │ 山田花子 │ React,Node.js │ 稼働中 │ [編集] │ │ │
│ │ │ EMP002 │ 佐藤次郎 │ Vue.js,Java  │ 稼働中 │ [編集] │ │ │
│ │ │ EMP003 │ 田中太郎 │ Python,AWS   │ 稼働中 │ [編集] │ │ │
│ │ └─────────────────────────────────────────────────┘ │ │
│ └─────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────┘
```

#### 3.4.2 人員詳細モーダル
```
┌─────────────────────────────────────────────────────────┐
│ 人員詳細情報                                    [×]     │
├─────────────────────────────────────────────────────────┤
│ 基本情報                                                │
│ 社員ID: EMP001                                          │
│ 氏名: 山田花子                                          │
│ メール: yamada@example.com                              │
│ 電話: 090-1234-5678                                     │
│ 稼働状況: [稼働中 ▼] 時給: [5000] 円                   │
│                                                         │
│ スキル情報                                    [+ 追加]  │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ React     │ 上級 │ 3.5年 │ 2024/01/15 │ [編集] [削除] │ │
│ │ Node.js   │ 中級 │ 2.0年 │ 2024/01/10 │ [編集] [削除] │ │
│ │ TypeScript│ 初級 │ 0.5年 │ 2024/01/05 │ [編集] [削除] │ │
│ └─────────────────────────────────────────────────────┘ │
│                                                         │
│ [キャンセル] [保存]                                     │
└─────────────────────────────────────────────────────────┘
```

#### 3.4.3 機能仕様
- **人員一覧**:
  - 人員情報の一覧表示
  - スキル情報の簡易表示
  - 稼働状況の表示
- **検索・フィルタ**:
  - 氏名検索
  - スキル検索
  - 稼働状況フィルタ
- **スキル管理**:
  - スキルの追加・編集・削除
  - 習熟度の設定
  - 経験年数の入力

### 3.5 スキルマッチング画面 (SKILL_MATCHING)

#### 3.5.1 レイアウト
```
┌─────────────────────────────────────────────────────────┐
│ スキルマッチング                                        │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────┐ ┌─────────────────────────────────┐ │
│ │ 要項選択        │ │ マッチング結果                  │ │
│ │ [要項選択 ▼]    │ │ ┌─────────────────────────────┐ │ │
│ │                 │ │ │ 山田花子 (EMP001)           │ │ │
│ │ ECサイト開発    │ │ │ 総合スコア: 85%             │ │ │
│ │ React, Node.js  │ │ │ ┌─────────────────────────┐ │ │ │
│ │ 経験3年以上     │ │ │ │ スキル: 80%             │ │ │ │
│ │                 │ │ │ │ 経験: 90%               │ │ │ │
│ │ [マッチング実行] │ │ │ │ 習熟度: 85%             │ │ │ │
│ └─────────────────┘ │ │ └─────────────────────────┘ │ │ │
│                     │ │ マッチ: React, Node.js      │ │ │
│                     │ │ 不足: TypeScript            │ │ │
│                     │ │ [詳細] [提案]               │ │ │
│                     │ └─────────────────────────────┘ │ │
│                     │ ┌─────────────────────────────┐ │ │
│                     │ │ 佐藤次郎 (EMP002)           │ │ │
│                     │ │ 総合スコア: 78%             │ │ │
│                     │ │ [詳細] [提案]               │ │ │
│                     │ └─────────────────────────────┘ │ │
│                     └─────────────────────────────────┘ │
└─────────────────────────────────────────────────────────┘
```

#### 3.5.2 マッチング詳細モーダル
```
┌─────────────────────────────────────────────────────────┐
│ マッチング詳細分析                              [×]     │
├─────────────────────────────────────────────────────────┤
│ 山田花子 (EMP001) - ECサイト開発                        │
│                                                         │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ スコア分析                                          │ │
│ │ 総合スコア: 85%                                     │ │
│ │ ┌─────────────────────────────────────────────────┐ │ │
│ │ │ スキルマッチ: 80%                               │ │ │
│ │ │ 経験年数: 90%                                   │ │ │
│ │ │ 習熟度: 85%                                     │ │ │
│ │ └─────────────────────────────────────────────────┘ │ │
│ └─────────────────────────────────────────────────────┘ │
│                                                         │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ スキル詳細                                          │ │
│ │ ✅ React (上級, 3.5年) - 完全一致                   │ │
│ │ ✅ Node.js (中級, 2.0年) - 完全一致                 │ │
│ │ ⚠️ TypeScript (初級, 0.5年) - 学習必要              │ │
│ │ ✅ PostgreSQL (中級, 1.5年) - 完全一致              │ │
│ └─────────────────────────────────────────────────────┘ │
│                                                         │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 推奨コメント                                        │ │
│ │ React経験が豊富で、Node.jsの経験もあります。        │ │
│ │ TypeScriptは短期学習で対応可能です。                 │ │
│ └─────────────────────────────────────────────────────┘ │
│                                                         │
│ [閉じる] [提案書作成]                                  │
└─────────────────────────────────────────────────────────┘
```

#### 3.5.3 機能仕様
- **要項選択**:
  - ドロップダウンで要項選択
  - 要項詳細の表示
- **マッチング実行**:
  - 自動マッチング計算
  - 結果の可視化
- **結果表示**:
  - スコアの円グラフ表示
  - 詳細分析の表示
  - 推奨コメントの表示

### 3.6 レポート画面 (REPORTS)

#### 3.6.1 レイアウト
```
┌─────────────────────────────────────────────────────────┐
│ レポート                                                │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 期間選択: [2024/01/01] ～ [2024/12/31] [更新]      │ │
│ └─────────────────────────────────────────────────────┘ │
│                                                         │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ マッチング統計                                      │ │
│ │ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐    │ │
│ │ │ 総マッチング │ │ 高推奨      │ │ 平均スコア   │    │ │
│ │ │    1,250    │ │    180      │ │    72.5%    │    │ │
│ │ └─────────────┘ └─────────────┘ └─────────────┘    │ │
│ └─────────────────────────────────────────────────────┘ │
│                                                         │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ スキル需要分析                                      │ │
│ │ ┌─────────────────────────────────────────────────┐ │ │
│ │ │ React     │████████████████████████████████████│ │ │
│ │ │ Node.js   │████████████████████████████████    │ │ │
│ │ │ PostgreSQL│████████████████████████████        │ │ │
│ │ └─────────────────────────────────────────────────┘ │ │
│ └─────────────────────────────────────────────────────┘ │
│                                                         │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 月別マッチング推移                                  │ │
│ │ [グラフエリア]                                      │ │
│ └─────────────────────────────────────────────────────┘ │
│                                                         │
│ [CSV出力] [PDF出力] [印刷]                             │
└─────────────────────────────────────────────────────────┘
```

#### 3.6.2 機能仕様
- **統計表示**:
  - マッチング統計
  - スキル需要分析
  - 月別推移グラフ
- **期間選択**:
  - カレンダーでの期間選択
  - リアルタイム更新
- **出力機能**:
  - CSV出力
  - PDF出力
  - 印刷機能

### 3.7 ユーザー設定画面 (USER_SETTINGS)

#### 3.7.1 レイアウト
```
┌─────────────────────────────────────────────────────────┐
│ ユーザー設定                                            │
├─────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────────────────────────────┐ │
│ │ プロフィール設定                                    │ │
│ │ 氏名: [田中太郎]                                   │ │
│ │ メール: [tanaka@example.com]                       │ │
│ │ 会社名: [株式会社サンプル]                          │ │
│ │ 部署: [営業部]                                     │ │
│ │ 電話: [03-1234-5678]                              │ │
│ └─────────────────────────────────────────────────────┘ │
│                                                         │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ 通知設定                                            │ │
│ │ □ メール通知を有効にする                            │ │
│ │ □ マッチング結果の通知                              │ │
│ │ □ システムメンテナンスの通知                        │ │
│ └─────────────────────────────────────────────────────┘ │
│                                                         │
│ ┌─────────────────────────────────────────────────────┐ │
│ │ パスワード変更                                      │ │
│ │ 現在のパスワード: [________]                        │ │
│ │ 新しいパスワード: [________]                        │ │
│ │ 確認: [________]                                    │ │
│ └─────────────────────────────────────────────────────┘ │
│                                                         │
│ [キャンセル] [保存]                                     │
└─────────────────────────────────────────────────────────┘
```

## 4. レスポンシブデザイン

### 4.1 ブレークポイント
- **モバイル**: 320px - 767px
- **タブレット**: 768px - 1023px
- **デスクトップ**: 1024px以上

### 4.2 モバイル対応
- **サイドバー**: ハンバーガーメニューに変更
- **テーブル**: 横スクロール対応
- **モーダル**: 全画面表示
- **ボタン**: タッチしやすいサイズ

## 5. アクセシビリティ

### 5.1 対応項目
- **キーボードナビゲーション**: Tabキーでの操作
- **スクリーンリーダー**: ARIA属性の設定
- **色のコントラスト**: WCAG 2.1 AA準拠
- **フォーカス表示**: 明確なフォーカス表示

### 5.2 ARIA属性
```html
<button aria-label="編集" aria-describedby="edit-help">
  編集
</button>
<div id="edit-help">このボタンで要項を編集できます</div>
```

## 6. エラーハンドリング

### 6.1 エラー表示
- **バリデーションエラー**: フィールド下に赤文字で表示
- **ネットワークエラー**: トースト通知で表示
- **システムエラー**: モーダルで表示

### 6.2 ローディング表示
- **ボタン**: ローディングスピナー
- **ページ**: スケルトンローダー
- **データ**: プログレスバー
